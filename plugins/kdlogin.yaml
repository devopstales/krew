# This file was generated by GoReleaser. DO NOT EDIT.
apiVersion: krew.googlecontainertools.github.com/v1alpha2
kind: Plugin
metadata:
  name: kdlogin
spec:
  version: v3.1.0
  platforms:
    - bin: kubectl-kdlogin.exe
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Windows_x86_64.zip
      sha256: 7a255f67bf73a250b73fce9e17565f4b750595381856c4f9c4bd7731e4a0b9b1
      selector:
        matchLabels:
          os: windows
          arch: amd64
    - bin: kubectl-kdlogin.exe
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Windows_arm64.zip
      sha256: 2ea86f0333c633c670d5fe637e3c2a8352b584f47b92fd50d2e16896fe4f7998
      selector:
        matchLabels:
          os: windows
          arch: arm64
    - bin: kubectl-kdlogin
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Linux_x86_64.tar.gz
      sha256: 4ab6d2cb1dae699525d27111a3c24e70ad260990b6c99ebc4cb7afe0c1e6de68
      selector:
        matchLabels:
          os: linux
          arch: amd64
    - bin: kubectl-kdlogin
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Linux_arm64.tar.gz
      sha256: 68248aa0a676b2f2b1747ecf73f268966ae7e836c636bfa9608632084f976da6
      selector:
        matchLabels:
          os: linux
          arch: arm64
    - bin: kubectl-kdlogin
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Darwin_x86_64.tar.gz
      sha256: 5dde91173bd4aefc72787fb39cedc05f28a758a9d635103abf7e40887ed45805
      selector:
        matchLabels:
          os: darwin
          arch: amd64
    - bin: kubectl-kdlogin
      uri: https://github.com/devopstales/KubeDash/releases/download/3.1.0/kubectl-kdlogin_Darwin_arm64.tar.gz
      sha256: 75b58ad9488a15d76a3030681c886c3a62686ab44c440a5191c087a4ef6f5c7b
      selector:
        matchLabels:
          os: darwin
          arch: arm64
  shortDescription: Login to a cluster via openid-connect
  homepage: https://devopstales.github.io
  caveats: |
    1) You need to install the kubedash server by helm:
        helm repo add devopstales https://devopstales.github.io/helm-charts
        helm repo update
        kubectl create ns kubedash
        kubens kubedash
        helm upgrade --install kubedash devopstales/kubedash -f values.yaml
    2) You need to setup the OIDC provider at Kubernetes API server.
        nano /etc/kubernetes/manifests/kube-apiserver.yaml
        ...
        command:
        - /hyperkube
        - apiserver
        ...
        - --oidc-issuer-url=<oidcServerURL>
        - --oidc-client-id=<oidcClientID>
        - --oidc-username-claim=email
        - --oidc-groups-claim=groups
        # for self sign cert or custom ca
        #- --oidc-ca-file=/etc/kubernetes/pki/rootca.pem
        systemctl restart kubelet
    3) You need to setup role binding for users or groupe.
  description: |
    Run `kubectl kdlogin <kubedash-ingress-url>`.
    It automatically opens the browser and you can log in to the provider.
    After authentication, it writes the token to the kubeconfig and you can access the cluster.
